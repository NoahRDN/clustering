global = configuration gÃ©nÃ©rale du moteur HAProxy
defaults = configuration par dÃ©faut pour les services HTTP/TCP

global
    log stdout format raw local0

-> log stout: permet d'afficher directement les erreru dans le terminal ou ils est lancer. (dans notre cas logs de docker asoosicer au HA-Proxy)
-> raw: format de sortie des logs dans le terminal (soit une logs remodifier par HA-Proxy, soit une logs simple tel quel sans modification effectuer par HA-proxy)
-> local0: categorie de log choisie dont dans notre cas, une log systeme maisil y a aussi d'autre sorte de log dont ce sera en cfonction de cela le log choisie par consequent (log0 a log7)

++++++++++
# ---------------------------
# PARAMÃˆTRES PAR DÃ‰FAUT
# ---------------------------
defaults
    mode http                 # HAProxy travaille ici en mode HTTP (non TCP)
    option httplog            # Active un format de log optimisÃ© pour HTTP
    option http-server-close  # Ferme la connexion aprÃ¨s chaque requÃªte
    timeout connect 5000      # Timeout de connexion au serveur backend (5s)
    timeout client  50000     # Timeout cÃ´tÃ© client (50s)
    timeout server  50000     # Timeout cÃ´tÃ© serveur (50s)

-> mode http: permet de donner la possibilite a HA-proxy de lire un http et d'avoir acces a des fonctionnalite autours de cela (par exemple: cookie)
-> option httplog : active un log adapte aux http, c'est a dire, afficher des log qui existe pour un http tel que code reponse, taile, temps Tq/Tw/Tc/Tr/Tt
-> option http-server-close: ferme connexion a chaque requete: 
    -> pour eviter que que chaque client monopolise la connexion 
    -> Favorise la rÃ©partition (round-robin) requÃªte par requÃªte
    -> Simplifie certains comportements (set-cookie par serveur, etc.)
        -> Certaines options HTTP (comme set-cookie) servent Ã  maintenir la session dâ€™un utilisateur sur un mÃªme serveur web (on appelle Ã§a une sticky session).
-> timeout connect 5000: delai maximal qu'HA-proxy utilise pour 

** Le round-robin est la stratÃ©gie dâ€™Ã©quilibrage par dÃ©faut de HAProxy.
    -> Chaque nouvelle requÃªte est envoyÃ©e Ã  tour de rÃ´le Ã  un serveur diffÃ©rent.

++++++++++++++++++++++++++++++++++++
# ---------------------------
# ğŸ”¹ FRONTEND - Point d'entrÃ©e
# ---------------------------
frontend http_front
    bind *:8080               # Ã‰coute sur le port 8080 (accessible via http://localhost:8080)
    default_backend web_back  # Redirige tout le trafic vers le backend nommÃ© "web_back"


-> frontend http_front	Le nom logique de ton point dâ€™entrÃ©e (possibilite ).
-> bind *:8080	: Ã©coute sur toutes les IP (*) sur le port 8080â€.
-> default_backend web_back: Toutes les requÃªtes reÃ§ues seront redirigÃ©es vers le backend web_back.


++++++++++++++++++++++++++++++++++++
backend web_back
    balance roundrobin
    cookie SRV insert indirect nocache
    option httpchk

    server web1 web1:80 cookie S1 check
    server web2 web2:80 cookie S2 check

-> balance roundrobin: rÃ©partir les requÃªtes Ã  tour de rÃ´le entre les serveurs disponibles
-> cookie SRV insert indirect nocache: 
    -> gere la persistence